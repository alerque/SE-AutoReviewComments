/*

// ==UserScript==
// @name           AutoReviewComments
// @namespace      benjol
// @version        1.3.3.3
// @description    No more re-typing the same comments over and over!
// @homepage       https://github.com/Benjol/SE-AutoReviewComments
// @grant          none
// @include /^https?:\/\/(.*\.)?stackoverflow\.com/.*$/
// @include /^https?:\/\/(.*\.)?serverfault\.com/.*$/
// @include /^https?:\/\/(.*\.)?superuser\.com/.*$/
// @include /^https?:\/\/(.*\.)?stackexchange\.com/.*$/
// @include /^https?:\/\/(.*\.)?askubuntu\.com/.*$/
// @include /^https?:\/\/(.*\.)?mathoverflow\.com/.*$/
// @include /^https?:\/\/discuss\.area51\.stackexchange\.com/.*$/
// @include /^https?:\/\/stackapps\.com/.*$/
// ==/UserScript==
*/
function with_jquery(e){var t=document.createElement("script");t.type="text/javascript";t.textContent="("+e.toString()+")(jQuery)";document.body.appendChild(t)}
with_jquery(function(e){StackExchange.ready(function(){function t(a){window.AutoReviewComments_AutoUpdateCallback=function(c){var d;a:{var b=v;d=c.split(".");for(b=b.split(".");d.length<b.length;)d.push("0");for(;b.length<d.length;)b.push("0");for(var e=0;e<d.length;e++){if(parseInt(d[e])>parseInt(b[e])){d=!0;break a}if(parseInt(d[e])<parseInt(b[e]))break}d=!1}d&&a(c,v,F)};e("<script />").attr("src",F).appendTo("head")}function G(a){var c=(new Date).setHours(0,0,0,0),d=f("LastUpdateCheckDay");null==
d?H(a,"Please read this!",'Thanks for installing this script.                             Please note that you can EDIT the texts inline by double-clicking them.                             For other options, please see the README at <a href="https://github.com/Benjol/SE-AutoReviewComments" target="_blank">here</a>.',function(){}):d!=c&&t(function(b,c,d){b!=f("LastVersionAcknowledged")&&H(a,"New Version!","A new version ("+b+') of the <a href="http://stackapps.com/q/2116">AutoReviewComments</a> userscript is now available, see the <a href="https://github.com/Benjol/SE-AutoReviewComments/releases">release notes</a> for details or <a href="'+
d+'">click here</a> to install now.',function(){h("LastVersionAcknowledged",b)})});h("LastUpdateCheckDay",c)}function f(a){return localStorage[z+a]}function h(a,c){localStorage[z+a]=c}function p(a){for(var c=localStorage.length-1;0<=c;c--){var d=localStorage.key(c);0==d.indexOf(z+a)&&localStorage.removeItem(d)}}function T(a){var c=new Date/1E3,d=(new Date).setHours(0,0,0)/1E3,d=c-d,c=c-a;if(c<I)return Math.round(c)+" seconds ago";if(c<J)return Math.round(c/I)+" minutes ago";if(c<d)return Math.round(c/
J)+" hours ago";if(c<K+d)return"yesterday";a=new Date(1E3*a);return c<L?"on "+M[a.getDay()]:a.toDateString()}function U(a){if(1E4>a)return a;if(1E5>a){var c=Math.floor(Math.round(a/100)/10);a=Math.round((a-1E3*c)/100);return c+(0<a?"."+a:"")+"k"}return Math.round(a/1E3)+"k"}function V(){var a=document.getElementsByClassName("profile-me");return a.length&&a[0].href.match(/\/users\/(\d+)\/.*/i)?RegExp.$1:""}function W(a){a=a.parents("div").find(".post-signature:last").first().find(".user-details > a:not([id])");
return a.length?a.attr("href").split("/")[2]:"[NULL]"}function X(){var a=e("#question").find(".owner").find(".user-details > a:not([id])");if(a.length)return a.text();a=e("#question").find(".owner").find(".user-details");return a.length?a.text():"[NULL]"}function Y(a,c){var d=c.find("#userinfo");isNaN(a)?d.fadeOutAndRemove():e.ajax({type:"GET",url:location.protocol+"//api.stackexchange.com/2.2/users/"+a+"?site="+w+"&jsonp=?",dataType:"jsonp",timeout:2E3,success:function(b){if(0<b.items.length){b=
b.items[0];new Date/1E3-b.creation_date<x&&(u=!0,c.find(".action-desc").prepend(q));A=b.display_name;var e=b.user_type.charAt(0).toUpperCase()+b.user_type.slice(1)+' user <strong><a href="/users/'+a+'" target="_blank">'+A+"</a></strong>,                                 member <strong>",g=b.creation_date,k=new Date/1E3,Z=new Date(1E3*g),f=(new Date).setHours(0,0,0)/1E3,f=k-f,g=k-g,k="";g<f?k="since today":g<K+f?k="since yesterday":g<L?k="since "+M[Z.getDay()]:g>y?(k="for "+Math.round(g/y)+" years",
g%y>r&&(k+=", "+Math.round(g%y/r)+" months")):g>r?(k="for "+Math.round(g/r)+" months",g%r>x&&(k+=", "+Math.round(g%r/x)+" weeks")):k="for "+Math.round(g/x)+" weeks";b=e+k+"</strong>,                                                                    last seen <strong>"+T(b.last_access_date)+"</strong>,                                                              reputation <strong>"+U(b.reputation)+"</strong>";d.html(b.replace(/ +/g," "))}else d.fadeOutAndRemove()},error:function(){d.fadeOutAndRemove()}})}
function $(a){var c=a.find("#main"),d=e('<div><textarea/><div class="actions"><a class="jsonp">jsonp</a><span class="lsep"> | </span><a class="save">save</a><span class="lsep"> | </span><a class="cancel">cancel</a></div></div>');d.css({position:"absolute",left:c.position().left,top:c.position().top,width:c.css("width"),height:c.css("height"),background:"white"});for(var c="",b=0;b<f("commentcount");b++)var l=f("name-"+b),g=f("desc-"+b),c=c+("###"+l+"\n"+B(g)+"\n\n");d.find("textarea").val(c);d.find(".jsonp").click(function(){for(var a=
"callback(\n[\n",b=0;b<f("commentcount");b++)a+='{ "name": "'+f("name-"+b)+'", "description": "'+f("desc-"+b).replace(/"/g,'\\"')+'"},\n\n';d.find("textarea").val(a+"]\n)");d.find("a:lt(2)").remove();d.find(".lsep:lt(2)").remove()});d.find(".cancel").click(function(){d.fadeOutAndRemove()});d.find(".save").click(function(){var b=d.find("textarea").val();p("name-");p("desc-");for(var b=b.split("\n"),c=0,g=0,f=0;f<b.length;f++){var l=e.trim(b[f]);0==l.indexOf("#")?(l=l.replace(/^#+/g,""),h("name-"+c,
l),c++):0<l.length&&(l=C(l),h("desc-"+g,D(l)),g++)}h("commentcount",Math.min(c,g));s(a);d.fadeOutAndRemove()});a.append(d)}function B(a){markdown=a.replace(/<a href="(.+?)">(.+?)<\/a>/g,"[$2]($1)").replace(/&amp;/g,"&");return markdown.replace(/<em>(.+?)<\/em>/g,"*$1*").replace(/<strong>(.+?)<\/strong>/g,"**$1**")}function C(a){html=a.replace(/\[([^\]]+)\]\((.+?)\)/g,'<a href="$2">$1</a>');return html.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*([^`]+?)\*/g,"<em>$1</em>")}function D(a){var c=
RegExp("http://"+w,"g"),d=RegExp("/"+E+"[)]","g");return a.replace(RegExp(n,"g"),"$SITENAME$").replace(c,"http://$SITEURL$").replace(d,"/$MYUSERID$)")}function aa(a){var c=a.html(),d=D(a.html().replace(q,""));if(!(-1<d.indexOf("<textarea"))){d=e("<textarea />").val(B(d));a.parent("label").attr("for","borken");var b=e('<div class="actions">'),f=e("<a>save</a>").click(function(){var b=e(this).parent().parent(),c=C(b.find("textarea").val());h(b.attr("id"),D(c));b.html((u?q:"")+c.replace(/\$SITENAME\$/g,
n).replace(/\$SITEURL\$/g,w).replace(/\$MYUSERID\$/g,E));N(a)}).add('<span class="lsep"> | </span>').add(e("<a>cancel</a>").click(function(){e(this).parent().parent().html(c);N(a)}));b.append(f);a.html(d.add(b))}}function N(a){a=a.parent("label");a.attr("for",a.prev().attr("id"))}function O(){p("name-");p("desc-");e.each(P,function(a,c){h("name-"+a,c.Name);h("desc-"+a,c.Description)});h("commentcount",P.length)}function s(a){f("commentcount")||O();var c=a.find(".action-list");c.empty();for(var d=
0;d<f("commentcount");d++){var b;b=f("name-"+d);b=-1<b.indexOf("[Q]")?"question":-1<b.indexOf("[A]")?"answer":"any";if("any"==b||b==a.posttype)b=f("desc-"+d).replace(/\$SITENAME\$/g,n).replace(/\$SITEURL\$/g,w).replace(/\$MYUSERID\$/g,E).replace(/\$/g,"$$$"),b=ba.replace(/\$ID\$/g,d).replace("$NAME$",f("name-"+d).replace(/\$/g,"$$$")).replace("$DESCRIPTION$",(u?q:"")+b),c.append(b)}Q(a);ca(a)}function ca(a){a.find("label > span").dblclick(function(){aa(e(this))});a.find("input:radio").click(function(){a.find(".popup-submit").removeAttr("disabled");
e(this).parents("ul").find(".action-selected").removeClass("action-selected");"hide"==f("hide-desc")&&e(this).parents("ul").find(".action-desc").hide();e(this).parent().addClass("action-selected").find(".action-desc").show()});a.find("input:radio").keyup(function(c){13==c.which&&(c.preventDefault(),a.find(".popup-submit").trigger("click"))})}function Q(a){a=a.find("ul.action-list li:not(.action-selected) span[id*='desc-']");"hide"==f("hide-desc")?a.hide():a.show()}function H(a,c,d,b){d=d.replace(/\n/g,
"<BR/>");c=e(da.replace("$TITLE$",c).replace("$BODY$",d));c.find(".notify-close").click(function(){e(this).parent().fadeOutAndRemove();b()});a.find("h2").before(c)}function ea(a,c,d){e.ajax({type:"GET",url:a+"?jsonp=?",dataType:"jsonp",jsonpCallback:"callback",timeout:2E3,success:c,error:d,async:!1})}function R(a,c,d){ea(a,function(a){h("commentcount",a.length);p("name-");p("desc-");e.each(a,function(a,b){h("name-"+a,b.name);h("desc-"+a,C(b.description))});c()},d)}function fa(a){var c=a.find("#remote-popup"),
d=c.find("#remoteerror1"),b=c.find("#remoteurl"),e=c.find("#remoteauto"),g=c.find("#throbber1");a.find(".popup-actions-remote").click(function(){b.val(f("RemoteUrl"));e.prop("checked","true"==f("AutoRemote"));c.show()});a.find(".remote-cancel").click(function(){g.hide();d.text("");c.hide()});a.find(".remote-save").click(function(){h("RemoteUrl",b.val());h("AutoRemote",e.prop("checked"));c.hide()});a.find(".remote-get").click(function(){g.show();R(b.val(),function(){s(a);g.hide()},function(a,b){d.text(b)})})}
function ga(a){var c=a.find("#welcome-popup"),d=c.find("#customwelcome");a.find(".popup-actions-welcome").click(function(){d.val(q);c.show()});a.find(".welcome-cancel").click(function(){c.hide()});a.find(".welcome-force").click(function(){u=!0;s(a);c.hide()});a.find(".welcome-save").click(function(){var a=""==d.val()?"NONE":d.val();h("WelcomeMessage",a);q=d.val();c.hide()})}var v="1.3.3.3",F="https://raw.github.com/Benjol/SE-AutoReviewComments/master/dist/autoreviewcomments.user.js",m;for(m in window)if(-1!=
m.indexOf("selfUpdaterCallback")){window[m](v);return}if(window.AutoReviewComments_AutoUpdateCallback)window.AutoReviewComments_AutoUpdateCallback(v);else{var w=window.location.hostname;m=document.title.split(" - ");var n=m[m.length-1],A="user",S="OP",z="AutoReviewComments-",E=V();"Stack Exchange"==n&&(n=m[m.length-2]);n=n.replace(/ ?Stack Exchange/,"");f("WelcomeMessage")||h("WelcomeMessage","Welcome to "+n+"! ");var q="NONE"==f("WelcomeMessage")?"":f("WelcomeMessage"),u=!1,da='<div class="auto-review-comments announcement" id="announcement"> <span class="notify-close"> <a title="dismiss this notification">x</a> </span> <strong>$TITLE$</strong> $BODY$ </div>',
ba='<li> <input id="comment-$ID$" type="radio" name="commentreview"/> <label for="comment-$ID$"> <span id="name-$ID$" class="action-name">$NAME$</span> <span id="desc-$ID$" class="action-desc">$DESCRIPTION$</span> </label> </li>',P=[{Name:"Answers just to say Thanks!",Description:'Please don\'t add "thanks" as answers. Invest some time in the site and you will gain sufficient <a href="http://$SITEURL$/privileges">privileges</a> to upvote answers you like, which is the $SITENAME$ way of saying thank you.'},
{Name:"Nothing but a URL (and isn't spam)",Description:'Whilst this may theoretically answer the question, <a href="http://meta.stackoverflow.com/q/8259">it would be preferable</a> to include the essential parts of the answer here, and provide the link for reference.'},{Name:"Requests to OP for further information",Description:"This is really a comment, not an answer. With a bit more rep, <a href=\"http://$SITEURL$/privileges/comment\">you will be able to post comments</a>. For the moment I've added the comment for you, and I'm flagging this post for deletion."},
{Name:"OP using an answer for further information",Description:"Please use the <em>Post answer</em> button only for actual answers. You should modify your original question to add additional information."},{Name:"OP adding a new question as an answer",Description:'If you have another question, please ask it by clicking the <a href="http://$SITEURL$/questions/ask">Ask Question</a> button.'},{Name:"Another user adding a 'Me too!'",Description:'If you have a NEW question, please ask it by clicking the <a href="http://$SITEURL$/questions/ask">Ask Question</a> button. If you have sufficient reputation, <a href="http://$SITEURL$/privileges/vote-up">you may upvote</a> the question. Alternatively, "star" it as a favorite and you will be notified of any new answers.'}],
M="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),I=60,J=3600,K=86400,L=518400,x=604800,r=2592E3,y=31536E3;m=e("<style>.auto-review-comments.popup{position:absolute;display:block;width:690px;padding:15px 15px 10px}.auto-review-comments.popup .float-left{float:left}.auto-review-comments.popup .float-right{float:right}.auto-review-comments.popup .throbber{display:none}.auto-review-comments.popup .remoteerror{color:red}.auto-review-comments.popup>div>textarea{width:100%;height:472px}.auto-review-comments.popup .main{overflow:hidden}.auto-review-comments.popup .main .userinfo{padding:5px;margin-bottom:7px;background:#eaefef}.auto-review-comments.popup .main .action-list{height:440px;margin:0 0 7px 0 !important;overflow-y:auto}.auto-review-comments.popup .main .action-list li{width:100%;padding:0;transition:.1s}.auto-review-comments.popup .main .action-list li:hover{background-color:#f2f2f2}.auto-review-comments.popup .main .action-list li.action-selected:hover{background-color:#e6e6e6}.auto-review-comments.popup .main .action-list li input{display:none}.auto-review-comments.popup .main .action-list li label{display:block;padding:10px}.auto-review-comments.popup .main .action-list li label .action-name{display:block;margin-bottom:3px;cursor:default}.auto-review-comments.popup .main .action-list li label .action-desc{margin:0;color:#888;cursor:default}.auto-review-comments.popup .main .action-list li label .action-name textarea,.auto-review-comments.popup .main .action-list li label .action-desc textarea{width:99%;margin:0 0 -4px 0}.auto-review-comments.popup .main .action-list li label .action-desc textarea{height:42px}.auto-review-comments.popup .main .share-tip{display:none}.auto-review-comments.popup .main .share-tip .customwelcome{width:300px}.auto-review-comments.popup .main .share-tip .remoteurl{display:block;width:400px}.auto-review-comments.popup .actions,.auto-review-comments.popup .main .popup-actions .actions{margin:6px}.auto-review-comments.popup .main .popup-actions .popup-submit{float:none;margin:0 0 5px 0}.auto-review-comments.announcement{padding:7px;margin-bottom:10px;background:orange;font-size:15px}.auto-review-comments.announcement .notify-close{display:block;float:right;margin:0 4px;padding:0 4px;border:2px solid black;cursor:pointer;line-height:17px}.auto-review-comments.announcement .notify-close a{color:black;text-decoration:none;font-weight:bold;font-size:16px}</style>");
e("head").append(m);e("#content").delegate(".comments-link","click",function(){var a=e(this).parent().attr("id").replace("-link",""),c=e(this).parents(".question, .answer").attr("class").split(" ")[0];if(!(0<e("#"+a).find(".comment-auto-link").length)){var d=e('<span class="lsep"> | </span>').add(e('<a class="comment-auto-link">auto</a>').click(function(){var b=e('<div class="auto-review-comments popup" id="popup"> <div class="popup-close" id="close"><a title="close this popup (or hit Esc)">&#215;</a></div> <h2 class="handle">Which review comment to insert?</h2> <div class="main" id="main"> <div class="popup-active-pane"> <div class="userinfo" id="userinfo"> <img src="http://sstatic.net/img/progress-dots.gif"/> </div> <ul class="action-list"> </ul> </div> <div class="share-tip" id="remote-popup"> enter url for remote source of comments (use import/export to create jsonp) <input class="remoteurl" id="remoteurl" type="text"/> <img class="throbber" id="throbber1" src="http://sstatic.net/img/progress-dots.gif"/> <span class="remoteerror" id="remoteerror1"></span> <div class="float-left"> <input type="checkbox" id="remoteauto"/> <label title="get from remote on every page refresh" for="remoteauto">auto-get</label> </div> <div class="float-right"> <a class="remote-get">get now</a> <span class="lsep"> | </span> <a class="remote-save">save</a> <span class="lsep"> | </span> <a class="remote-cancel">cancel</a> </div> </div> <div class="share-tip" id="welcome-popup"> configure "welcome" message (empty=none): <div> <input class="customwelcome" id="customwelcome" type="text"/> </div> <div class="float-right"> <a class="welcome-force">force</a> <span class="lsep"> | </span> <a class="welcome-save">save</a> <span class="lsep"> | </span> <a class="welcome-cancel">cancel</a> </div> </div> <div class="popup-actions"> <div class="float-left actions"> <a title="close this popup (or hit Esc)" class="popup-actions-cancel">cancel</a> <span class="lsep"> | </span> <a title="see info about this popup" class="popup-actions-help" href="http://stackapps.com/q/2116" target="_blank">info</a> <span class="lsep"> | </span> <a class="popup-actions-see">see-through</a> <span class="lsep"> | </span> <a title="reset any custom comments" class="popup-actions-reset">reset</a> <span class="lsep"> | </span> <a title="use this to import/export all comments" class="popup-actions-impexp">import/export</a> <span class="lsep"> | </span> <a title="use this to hide/show all comments" class="popup-actions-toggledesc">show/hide desc</a> <span class="lsep"> | </span> <a title="setup remote source" class="popup-actions-remote">remote</a> <img class="throbber" id="throbber2"src="http://sstatic.net/img/progress-dots.gif"/> <span class="remoteerror" id="remoteerror2"></span> <span class="lsep"> | </span> <a title="configure welcome" class="popup-actions-welcome">welcome</a> </div> <div class="float-right"> <input class="popup-submit" type="button" disabled="disabled" value="Insert"> </div> </div> </div> </div>');
b.find(".popup-close").click(function(){b.fadeOutAndRemove()});b.posttype=c;u=!1;s(b);b.find(".popup-actions-cancel").click(function(){b.fadeOutAndRemove()});b.find(".popup-actions-reset").click(function(){O();s(b)});b.find(".popup-actions-see").hover(function(){b.fadeTo("fast","0.4").children().not("#close").fadeTo("fast","0.0")},function(){b.fadeTo("fast","1.0").children().not("#close").fadeTo("fast","1.0")});b.find(".popup-actions-impexp").click(function(){$(b)});b.find(".popup-actions-toggledesc").click(function(){var a=
f("hide-desc")||"show";h("hide-desc","show"==a?"hide":"show");Q(b)});fa(b);ga(b);b.find(".popup-submit").click(function(){if(!b.find(".popup-submit").is(":disabled")){var c=b.find("input:radio:checked"),c=B(c.parent().find(".action-desc").html()).replace(/\[username\]/g,A).replace(/\[OP\]/g,S);e("#"+a).find("textarea").val(c).focus();c=c.indexOf("[type here]");0<=c&&e("#"+a).find("textarea")[0].setSelectionRange(c,c+11);b.fadeOutAndRemove()}});if(!window.VersionChecked&&"true"==f("AutoRemote")){var d=
b.find("#throbber2"),g=b.find("#remoteerror2");d.show();R(f("RemoteUrl"),function(){s(b);d.hide()},function(a,b){g.text(b)})}e("#"+a).append(b);b.center();StackExchange.helpers.bindMovablePopups();var k=W(e(this));Y(k,b);S=X();"function"!=typeof G||window.VersionChecked||(G(b),window.VersionChecked=!0)}));setTimeout(function(){e("#"+a).find(".comment-help-link").parent().append(d)},15)}})}})});
